(this["webpackJsonpreact-three-fiber"]=this["webpackJsonpreact-three-fiber"]||[]).push([[0],{12:function(e,t){var r=30;e.exports={gridSize:r,boxSize:3,indexesToCheck:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=1800,c=Math.round(e.x/3),i=Math.round(e.z/3),o=(i+1)*r-(r-c),a=[],s=-t;s<=t;s++)for(var j=s*r,u=-t;u<=t;u++){var b=o+j+u,O=o+j+u+900;b>0&&b<n&&a.push(b),O>0&&O<n&&a.push(O)}return a}}},41:function(e,t,r){},42:function(e,t,r){},51:function(e,t,r){"use strict";r.r(t);var n=r(7),c=r.n(n),i=r(31),o=r.n(i),a=(r(41),r(14)),s=r(10),j=(r(42),r(17)),u=r(35),b=r(9),O=Object(n.createContext)(),d=function(e){var t=Object(n.useState)({x:0,y:0,z:0}),r=Object(s.a)(t,2),c=r[0],i=r[1];return Object(b.jsx)(O.Provider,{value:{position:c,setPosition:i},children:e.children})},f=Object(n.createContext)(),h=function(e){window.iter=0;var t=Object(n.useState)([]),r=Object(s.a)(t,2),c=r[0],i=r[1];return Object(b.jsx)(f.Provider,{value:{objects:c,setObjects:i},children:e.children})},l=r(8),x=r(6),m=r(12),g=.3,S=.5;function v(){var e=Object(n.useState)(!0),t=Object(s.a)(e,2),r=t[0],c=t[1],i=Object(n.useState)(g),o=Object(s.a)(i,2),a=o[0],u=o[1],d=Object(n.useState)({x:0,y:0,z:0}),h=Object(s.a)(d,2),v=h[0],y=h[1],p=Object(n.useContext)(f).objects,w=Object(n.useContext)(O).setPosition,z=Object(j.e)(),k=z.camera,M=z.gl,C=Object(n.useRef)(),L=Object(n.useState)(performance.now()),A=Object(s.a)(L,2),E=A[0],P=A[1],F=Object(n.useState)(!0),T=Object(s.a)(F,2),J=T[0],N=T[1],R=Object(n.useState)(!1),I=Object(s.a)(R,2),D=I[0],G=I[1],B=Object(n.useState)({forward:0,right:0,y:0}),V=Object(s.a)(B,2),W=V[0],q=V[1];return Object(n.useEffect)((function(){var e=function(){C.current.lock()},t=function(e){var t=e.key,r={l:function(){return C.current.lock()},u:function(){return C.current.unlock()},c:function(){return console.log({current:C.current,getObject:C.current.getObject()})},i:function(){var e=C.current.getObject().position,t=Math.round(e.x/m.boxSize),r=(Math.round(e.z/m.boxSize)+1)*m.gridSize-(m.gridSize-t);console.log({intersections:Object(m.indexesToCheck)(e,1),index:r})},e:function(){return q((function(e){return Object(l.a)(Object(l.a)({},e),{},{y:50})})),void N(!0)}," ":function(){D&&!J&&(q((function(e){return Object(l.a)(Object(l.a)({},e),{},{y:35})})),N(!0))},p:function(){return c((function(e){return!e}))}};r[t=t.toLowerCase()]&&r[t]()},r=function(e){var t=e.key,r={w:function(){return q((function(e){return Object(l.a)(Object(l.a)({},e),{},{forward:a})}))},a:function(){return q((function(e){return Object(l.a)(Object(l.a)({},e),{},{right:-a})}))},s:function(){return q((function(e){return Object(l.a)(Object(l.a)({},e),{},{forward:-a})}))},d:function(){return q((function(e){return Object(l.a)(Object(l.a)({},e),{},{right:a})}))},shift:function(){return u(S)}};r[t=t.toLowerCase()]&&r[t]()},n=function(e){var t=e.key,r={w:function(){return q((function(e){return Object(l.a)(Object(l.a)({},e),{},{forward:0})}))},a:function(){return q((function(e){return Object(l.a)(Object(l.a)({},e),{},{right:0})}))},s:function(){return q((function(e){return Object(l.a)(Object(l.a)({},e),{},{forward:0})}))},d:function(){return q((function(e){return Object(l.a)(Object(l.a)({},e),{},{right:0})}))},shift:function(){return u(g)}};r[t=t.toLowerCase()]&&r[t]()};return window.addEventListener("mousedown",e),window.addEventListener("keypress",t),window.addEventListener("keydown",r),window.addEventListener("keyup",n),function(){window.removeEventListener("mousedown",e),window.removeEventListener("keypress",t),window.removeEventListener("keydown",r),window.removeEventListener("keyup",n)}}),[J,D,a]),Object(j.c)((function(){C.current.getObject().far=100,C.current.getObject().updateProjectionMatrix();var e=C.current.getObject().position,t=new x.Raycaster(new x.Vector3,new x.Vector3(0,-1,0),0,2);t.ray.origin.copy(e),t.ray.origin.y-=4;var n=Object(m.indexesToCheck)(e,1),c=t.intersectObjects(n.map((function(e){return p[e]})));G(c.length>0||e.y<=-50);var i=performance.now(),o=(i-E)/1e3;C.current.moveForward(W.forward),C.current.moveRight(W.right),J&&(e.y=Math.max(W.y*o+e.y,-50));var s=98*o;q(r?function(e){return Object(l.a)(Object(l.a)({},e),{},{y:Math.max(e.y-s,-20)})}:function(e){return Object(l.a)(Object(l.a)({},e),{},{y:0})}),P(i),D&&-20===W.y&&(q((function(e){return Object(l.a)(Object(l.a)({},e),{},{y:0})})),N(!1)),D||J||(q((function(e){return Object(l.a)(Object(l.a)({},e),{},{y:0})})),N(!0)),y(e),w(e),localStorage.setItem("debug",JSON.stringify({currentRef:e,shouldReset:e.y<-50,jumping:J,onObject:D,canJump:D&&!J,movementSpeed:a}))})),Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("pointerLockControls",{ref:C,args:[k,M.domElement]}),Object(b.jsx)("pointLight",{color:16777215,position:[v.x,v.y,v.z],intensity:.1,decay:2})]})}var y=r(34),p=r(36),w=r(37);Object(j.b)({PointerLockControls:u.a,Text:w.a});var z=Object(y.makeNoise3D)(),k=Array.from({length:m.gridSize}).map((function(e,t){return Array.from({length:m.gridSize}).map((function(e,r){return Math.round(z(t/10,r/10,0))}))})),M={x:m.gridSize*m.boxSize/2,y:80,z:m.gridSize*m.boxSize/2};function C(){return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(L,{}),Object(b.jsx)(A,{}),Object(b.jsx)(E,{})]})}function L(){return Object(b.jsx)("div",{id:"canvas-container",children:Object(b.jsx)(j.a,{children:Object(b.jsx)(n.Suspense,{fallback:null,children:Object(b.jsx)(d,{children:Object(b.jsxs)(h,{children:[Object(b.jsx)("ambientLight",{intensity:.075}),Object(b.jsx)("pointLight",{color:13217332,position:[M.x,M.y,M.z]}),Object(b.jsxs)("mesh",{position:[M.x,M.y,M.z],children:[Object(b.jsx)("boxGeometry",{args:[2,2,2]}),Object(b.jsx)("meshPhongMaterial",{})]}),Object(b.jsx)(P,{}),Object(b.jsx)(v,{})]})})})})})}function A(){var e=Object(n.useState)({}),t=Object(s.a)(e,2),r=t[0],c=t[1];return Object(n.useEffect)((function(){window.requestAnimationFrame((function(){c(JSON.parse(localStorage.getItem("debug")))}))})),Object(b.jsxs)("div",{className:"debug",children:[Object(b.jsx)("div",{children:"Controls:"}),Object(b.jsx)("div",{children:"WASD to move"}),Object(b.jsx)("div",{children:"mouse to look"}),Object(b.jsx)("div",{children:"space to jump"}),Object(b.jsx)("div",{children:"click to lock cursor"}),Object(b.jsx)("div",{children:"esc or u to unlock cursor"}),Object(b.jsx)("div",{children:"e to fly"}),Object(b.jsx)("pre",{children:Object(b.jsxs)("code",{children:["state: ",JSON.stringify(r,null,2)]})})]})}function E(){return Object(b.jsx)("div",{className:"crosshair",children:Object(b.jsx)("p",{children:"+"})})}function P(){var e=-20,t=(Object(n.useContext)(O).position,Object(n.useContext)(f).setObjects),r=Object(n.useRef)({});Object(n.useEffect)((function(){t(r.current)}),[r,t]);var c=Object(j.d)(p.a,["/images/grass-top.jpeg","/images/grass-side.jpeg","/images/grass-bottom.jpeg"]),i=Object(s.a)(c,3),o=i[0],u=i[1],d=i[2],h=Object(n.useState)([0,0,90,0]),l=Object(s.a)(h,2),x=(l[0],l[1],Object(n.useState)({font:"Philosopher",fontSize:2,color:"#99ccff",maxWidth:300,lineHeight:1,letterSpacing:0,textAlign:"justify",materialType:"MeshPhongMaterial"})),g=Object(s.a)(x,2);g[0],g[1];return Object(b.jsx)(b.Fragment,{children:Object(a.a)(Array.from({length:m.gridSize}).map((function(t,n){return Array.from({length:m.gridSize}).map((function(t,c){var i=k[n][c];return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsxs)("mesh",{position:[n*m.boxSize,i*m.boxSize+e,c*m.boxSize],ref:function(e){r.current[n+c*m.gridSize]=e},children:[Object(b.jsx)("boxGeometry",{args:[m.boxSize,m.boxSize,m.boxSize],attach:"geometry"}),Object(b.jsx)("meshStandardMaterial",{map:u,attachArray:"material"}),Object(b.jsx)("meshStandardMaterial",{map:u,attachArray:"material"}),Object(b.jsx)("meshStandardMaterial",{map:o,attachArray:"material"}),Object(b.jsx)("meshStandardMaterial",{map:d,attachArray:"material"}),Object(b.jsx)("meshStandardMaterial",{map:u,attachArray:"material"}),Object(b.jsx)("meshStandardMaterial",{map:u,attachArray:"material"})]},[n,c].join()),Object(b.jsxs)("mesh",{position:[n*m.boxSize,i*m.boxSize+e-m.boxSize,c*m.boxSize],ref:function(e){r.current[n+c*m.gridSize+m.gridSize*m.gridSize]=e},children:[Object(b.jsx)("boxGeometry",{args:[m.boxSize,m.boxSize,m.boxSize],attach:"geometry"}),Object(b.jsx)("meshStandardMaterial",{map:u,attach:"material"})]},[n,c,2].join())]})}))})))})}var F=function(e){e&&e instanceof Function&&r.e(3).then(r.bind(null,52)).then((function(t){var r=t.getCLS,n=t.getFID,c=t.getFCP,i=t.getLCP,o=t.getTTFB;r(e),n(e),c(e),i(e),o(e)}))};o.a.render(Object(b.jsx)(c.a.StrictMode,{children:Object(b.jsx)(C,{})}),document.getElementById("root")),F()}},[[51,1,2]]]);
//# sourceMappingURL=main.b17d4d4f.chunk.js.map